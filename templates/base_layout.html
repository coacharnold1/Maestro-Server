<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Maestro-MPD{% endblock %}</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 5px;
            background-color: #1a1a1a;
            color: #ecf0f1;
            display: flex;
            flex-direction: column; /* Stack footer below content */
            justify-content: flex-start;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 400px;
            background-color: #2c3e50;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 5px 18px rgba(0, 0, 0, 0.4);
            box-sizing: border-box;
        }

        h1,
        h2 {
            color: #ecf0f1;
            text-align: center;
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        h2 {
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .status-box {
            border: 1px solid #34495e;
            padding: 10px;
            border-radius: 8px;
            background-color: #34495e;
            margin-bottom: 10px;
        }

        .status-item {
            margin-bottom: 3px;
            font-size: 0.9em;
            line-height: 1.2;
        }

        .status-item span {
            font-weight: bold;
            color: #bdc3c7;
        }

        .disconnected {
            color: #e74c3c;
            font-weight: bold;
        }

        .connected {
            color: #2ecc71;
            font-weight: bold;
        }

        .controls {
            text-align: center;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #34495e;
        }

        .controls:first-of-type {
            border-top: none;
            padding-top: 0;
        }

        .controls button,
        .button {
            background-color: #ecf0f1;
            color: #2c3e50;
            border: none;
            padding: 7px 12px;
            margin: 2px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            min-width: 70px;
            font-weight: bold;
            text-decoration: none;
            display: inline-block;
        }

        .controls button:hover,
        .button:hover {
            background-color: #bdc3c7;
            transform: translateY(-1px);
        }

        .controls button:active,
        .button:active {
            transform: translateY(0);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .controls button:disabled {
            background-color: #6c7a89;
            color: #aeb6bf;
            cursor: not-allowed;
            box-shadow: none;
        }

        .mpd-actions button {
            background-color: #f1c40f;
            color: #2c3e50;
        }

        .mpd-actions button:hover {
            background-color: #f39c12;
        }

        .system-actions button {
            background-color: #9b59b6;
            color: #ecf0f1;
        }

        .system-actions button:hover {
            background-color: #8e44ad;
        }

        .refresh-control button {
            background-color: #7f8c8d;
            color: #ecf0f1;
        }

        .refresh-control button:hover {
            background-color: #6c7a7b;
        }

        .album-art {
            text-align: center;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        .album-art img {
            max-width: 300px;
            max-height: 300px;
            width: auto;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 2px solid #34495e;
            object-fit: contain;
        }

        .volume-slider-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            padding: 10px;
            border-top: 1px solid #34495e;
            flex-wrap: wrap;
        }

        .volume-slider-container label {
            margin-right: 10px;
            font-weight: bold;
            color: #bdc3c7;
            white-space: nowrap;
        }

        .volume-slider-container input[type="range"] {
            -webkit-appearance: none;
            width: 70%;
            height: 8px;
            background: #555;
            outline: none;
            opacity: 0.9;
            -webkit-transition: .2s;
            transition: opacity .2s;
            border-radius: 5px;
            margin: 0 10px;
        }

        .volume-slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #1abc9c;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .volume-slider-container input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #1abc9c;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .volume-value {
            font-weight: bold;
            color: #1abc9c;
            min-width: 40px;
            text-align: right;
        }

        .progress-container {
            width: 100%;
            background-color: #555;
            border-radius: 5px;
            margin-top: 10px;
            height: 8px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: #2ecc71;
            border-radius: 5px;
            transition: width 0.5s ease-out;
        }

        .search-actions button {
            background-color: #3498db;
            color: #ecf0f1;
        }

        .search-actions button:hover {
            background-color: #2980b9;
        }

        .search-actions .button-row {
            display: flex;
            justify-content: center;
            margin-bottom: 5px;
        }

        .search-actions .button-row:last-child {
            margin-bottom: 0;
        }

        .search-actions .button-row button {
            flex: 1;
            margin: 2px;
        }

        .add-music-btn button {
            background-color: #e67e22;
            color: #ecf0f1;
        }

        .add-music-btn button:hover {
            background-color: #d35400;
        }

        .playlist-btn button {
            background-color: #3498db;
            color: #ecf0f1;
        }

        .playlist-btn button:hover {
            background-color: #2980b9;
        }

        .playback-controls button {
            background-color: #2ecc71;
            color: #ecf0f1;
        }

        .playback-controls button:hover {
            background-color: #27ae60;
        }

        .mpd-options-controls {
            text-align: center;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #34495e;
        }

        .mpd-options-controls .form-group {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
        }

        .mpd-options-controls .form-group label {
            margin-left: 8px;
            font-weight: normal;
        }

        .song-list {
            list-style-type: none;
            padding: 0;
        }

        .song-list li {
            background-color: #34495e;
            padding: 10px;
            margin-bottom: 5px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
        }

        .song-info {
            flex-grow: 1;
            margin-right: 10px;
        }

        .song-info .title {
            font-weight: bold;
            color: #1abc9c;
        }

        .song-info .artist,
        .song-info .album {
            color: #bdc3c7;
        }

        .song-actions .add-button {
            background-color: #1abc9c;
            color: #ecf0f1;
            padding: 5px 10px;
            text-decoration: none;
            border-radius: 5px;
            font-size: 0.8em;
            white-space: nowrap;
        }

        .song-actions .add-button:hover {
            background-color: #16a085;
        }

        .message-container {
            width: 100%;
            margin-bottom: 10px;
            text-align: center;
        }

        .message {
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9em;
            color: #1a1a1a;
            font-weight: bold;
        }

        .message.success {
            background-color: #2ecc71;
        }

        .message.error {
            background-color: #e74c3c;
            color: #ffffff;
        }

        .message.warning {
            background-color: #f1c40f;
        }

        /* Minimal theme overrides */
        body.light {
            background-color: #f5f5f7;
            color: #1a1a1a;
        }
        body.light .container {
            background-color: #ffffff;
            color: #1a1a1a;
        }
        body.light .status-box, body.light .song-list li {
            background-color: #f0f3f6;
            border-color: #d0d7de;
        }
        body.high-contrast {
            background-color: #000000;
            color: #ffff00;
        }
        body.high-contrast .container {
            background-color: #000000;
            color: #ffff00;
            border: 2px solid #ffff00;
        }
        body.high-contrast .status-box, body.high-contrast .song-list li {
            background-color: #000000;
            border: 2px solid #ffff00;
        }

        /* Desert theme */
        body.desert {
            background-color: #2c1810;
            color: #f4e4bc;
        }
        body.desert .container {
            background-color: #3d2f20;
            color: #f4e4bc;
            border-color: #8b4513;
        }
        body.desert .status-box, body.desert .song-list li {
            background-color: #4a3b2a;
            border-color: #cd853f;
        }

        @media (max-width: 450px) {
            body {
                padding: 5px;
            }

            .container {
                padding: 8px;
            }

            h1 {
                font-size: 1.2em;
                margin-bottom: 8px;
            }

            h2 {
                font-size: 1em;
                margin-bottom: 6px;
            }

            .status-item {
                font-size: 0.85em;
            }

            .controls button,
            .button {
                padding: 5px 8px;
                font-size: 0.75em;
                min-width: unset;
                width: calc(50% - 4px);
            }

            .controls {
                margin-top: 8px;
                padding-top: 8px;
            }

            .button-container {
                display: flex;
                justify-content: center;
                margin-top: 10px;
            }

            .album-art img {
                max-width: 250px;
                max-height: 250px;
            }

            .center-container {
                text-align: center;
                margin-top: 10px;
            }

            .volume-slider-container {
                flex-direction: column;
                align-items: center;
            }

            .volume-slider-container label,
            .volume-value {
                margin: 5px 0;
            }

            .volume-slider-container input[type="range"] {
                width: 90%;
                margin: 10px 0;
            }

            .song-list li {
                flex-direction: column;
                align-items: flex-start;
            }

            .song-actions {
                margin-top: 5px;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
</head>

<body class="{{ app_theme }}">
    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="message-container">
            {% for category, message in messages %}
            <div class="message {{ category }}">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </div>
    
    <!-- Footer with version info -->
    <footer style="text-align: center; padding: 15px; color: #ecf0f1; background-color: #2c3e50; font-size: 14px; border-top: 2px solid #3498db; margin-top: 30px;">
        <span id="version-info">Loading version info...</span>
        &nbsp;•&nbsp;
        <a href="/settings" style="color:#bdc3c7; text-decoration: none;">Settings</a>
        &nbsp;•&nbsp;
        <a href="/charts" style="color:#bdc3c7; text-decoration: none;">Charts</a>
    </footer>
    
    <script>
        // Fetch version info from API
        fetch('/api/version')
            .then(response => response.json())
            .then(data => {
                const versionText = `${data.app_name} v${data.version} (${data.build_date})`;
                const versionElement = document.getElementById('version-info');
                const testVersionElement = document.getElementById('test-version-info');
                
                if (versionElement) versionElement.textContent = versionText;
                if (testVersionElement) testVersionElement.textContent = versionText;
            })
            .catch(() => {
                const fallbackText = 'MPD Web Control - Enhanced Edition v1.0.0';
                const versionElement = document.getElementById('version-info');
                const testVersionElement = document.getElementById('test-version-info');
                
                if (versionElement) versionElement.textContent = fallbackText;
                if (testVersionElement) testVersionElement.textContent = fallbackText;
            });
    </script>
</body>

</html>